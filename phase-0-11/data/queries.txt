LOAD EMPLOYEE
LOAD WORKS_ON

Q1A <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM Q1A

Q2_CROSS <- CROSS EMPLOYEE EMPLOYEE
Q2A <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM Q2_CROSS
Q2B <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM Q2A
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE1_Super_ssn, EMPLOYEE1_Bdate FROM Q2B
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2

Q3_CROSS <- CROSS EMPLOYEE WORKS_ON
Q3_CROSS_SUBSET <- SELECT Ssn == Essn FROM Q3_CROSS
Q3_SEL <- PROJECT Pno, Sex FROM Q3_CROSS_SUBSET
Q3_P_CROSS <- CROSS Q3_SEL Q3_SEL
Q3_P_SEL <- SELECT Q3_SEL1_Pno == Q3_SEL2_Pno FROM Q3_P_CROSS
Q3_P_SEX <- SELECT Q3_SEL1_Sex != Q3_SEL2_Sex FROM Q3_P_SEL
Q3 <- PROJECT Q3_SEL1_Pno FROM Q3_P_SEX
RENAME Q3_SEL1_Pno TO Pno FROM Q3

Q4_CROSS <- CROSS EMPLOYEE WORKS_ON
Q4_CROSS1 <- SELECT Ssn == Essn FROM Q4_CROSS
Q4A <- PROJECT Ssn, Super_ssn, Pno FROM Q4_CROSS1
Q4A_CROSS <- CROSS Q4A Q4A
Q4B <- SELECT Q4A1_Super_ssn == Q4A2_Ssn FROM Q4A_CROSS
Q4C <- SELECT Q4A1_Pno == Q4A2_Pno FROM Q4B
RENAME Q4A1_Ssn TO Ssn FROM Q4C
RENAME Q4A1_Super_ssn TO Super_ssn FROM Q4C
RENAME Q4A1_Pno TO Pno FROM Q4C
Q4 <- PROJECT Ssn, Super_ssn, Pno FROM Q4C

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4

QUIT